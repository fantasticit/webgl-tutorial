(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{36:function(n,s,r){"use strict";r.r(s);var a={components:{}},e=r(2),t=Object(e.a)(a,function(){var n=this,s=n.$createElement,r=n._self._c||s;return r("section",[r("h1",[n._v("在 3D 空间中模拟现实灯光")]),n._v(" "),r("p",[n._v("光源类型可以概括成如下三种：")]),n._v(" "),n._m(0),n._v(" "),r("p",[n._v("关于方向光还是有两点需要注意一下：")]),n._v(" "),n._m(1),n._v(" "),r("p",[n._v("接下来的例子会更新顶点着色器，考虑到环境光，再考虑到方向光（方向光的作用会因为光线方向与面的夹角关系而不同），计算每一个顶点的颜色。")]),n._v(" "),r("h2",[n._v("1. 建立顶点法线")]),n._v(" "),r("p",[n._v("首先建立一个数组来存放立方体所有顶点的法线。")]),n._v(" "),n._m(2),n._v(" "),n._m(3),n._v(" "),n._m(4),n._v(" "),r("p",[n._v("然后在着色器中建立和传递法线向量矩阵，用这个矩阵来处理当前立方体相对于光源位置法线向量的转换。")]),n._v(" "),n._m(5),n._v(" "),r("h2",[n._v("2. 更新着色器")]),n._v(" "),r("p",[n._v("现在着色器需要的所有数据已经全部可以获取到了（或者说全部准备好了），需要更新下着色器本身的代码。")]),n._v(" "),r("h2",[n._v("2.1 顶点着色器")]),n._v(" "),r("p",[n._v("首先更新顶点着色器，让它给每一个基于环境光和方向光的顶点一个着色器值。让我们看下代码：")]),n._v(" "),n._m(6),n._v(" "),r("p",[n._v("一旦顶点位置计算完毕，就可以获得纹理对应于顶点的坐标，从而计算出顶点的阴影。")]),n._v(" "),r("p",[n._v("当方向光的量计算完，我们可以通过获取环境光并且添加方向光的颜色和要提供的定向光的量来生成光照值（lighting value）。最终结果会得到一个 RGB 值，用于片段着色器调整渲染的每一个像素的颜色。")]),n._v(" "),r("h3",[n._v("2.2 片段着色器")]),n._v(" "),r("p",[n._v("片段着色器现在需要根据顶点着色器计算出的光照值来更新：")]),n._v(" "),n._m(7),n._v(" "),r("block-demo",{attrs:{tip:"",source:"const app = document.querySelector('#app')\nconst canvas = document.createElement('canvas')\ncanvas.width = 400\ncanvas.height = 300\n\napp.appendChild(canvas)\n\nconst gl = canvas.getContext('webgl')\n\nstart()\n\nfunction start() {\n  // 顶点着色器\n  const vsScource = `\n        attribute vec4 aVertexPosition;\n        attribute vec3 aVertexNormal;\n        attribute vec2 aTextureCoord;\n\n        uniform mat4 uModelViewMatrix;\n        uniform mat4 uNormalMatrix;\n        uniform mat4 uProjectionMatrix;\n\n        varying highp vec2 vTextureCoord;\n        varying highp vec3 vLighting;\n\n        void main() {\n          vTextureCoord = aTextureCoord;\n          gl_Position  = uProjectionMatrix * uModelViewMatrix * aVertexPosition;\n\n\n          highp vec3 ambientLight = vec3(0.3, 0.3, 0.3);\n          highp vec3 directionalLightColor = vec3(1, 1, 1);\n          highp vec3 directionalVector = normalize(vec3(0.85, 0.8, 0.75));\n          highp vec4 transformedNormal = uNormalMatrix * vec4(aVertexNormal, 1.0);\n          highp float directional = max(dot(transformedNormal.xyz, directionalVector), 0.0);\n          vLighting = ambientLight + (directionalLightColor * directional);\n        }\n\n\n      `\n\n  // 片段着色器\n  const fsSource = `\n        varying highp vec2 vTextureCoord;\n        varying highp vec3 vLighting;\n\n        uniform sampler2D uSampler;\n\n        void main() {\n          highp vec4 texelColor = texture2D(uSampler, vTextureCoord);\n          gl_FragColor = vec4(texelColor.rgb * vLighting, texelColor.a);\n        }\n      `\n\n  // 0： 创建 着色器连接程序 以告诉 WebGL 如何渲染数据\n  const shaderProgram = initShaderProgram(gl, vsScource, fsSource)\n  const programInfo = {\n    program: shaderProgram,\n    attribLocations: {\n      vertexPosition: gl.getAttribLocation(shaderProgram, 'aVertexPosition'),\n      // vertexColor: gl.getAttribLocation(shaderProgram, \"aVertexColor\"),\n      textureCoord: gl.getAttribLocation(shaderProgram, 'aTextureCoord'),\n      vertexNormal: gl.getAttribLocation(shaderProgram, 'aVertexNormal')\n    },\n    uniformLocations: {\n      projectionMatrix: gl.getUniformLocation(\n        shaderProgram,\n        'uProjectionMatrix'\n      ),\n      modelViewMatrix: gl.getUniformLocation(shaderProgram, 'uModelViewMatrix'),\n      sampler: gl.getUniformLocation(shaderProgram, 'uSampler'),\n      normalMatrix: gl.getUniformLocation(shaderProgram, 'uNormalMatrix')\n    }\n  }\n\n  // 1. 创建 缓冲区 存储所绘制图形的顶点\n  const buffers = initBuffers(gl)\n\n  const texture = loadTextures(\n    gl,\n    'http://p4.qhimg.com/t01836de9c0b1068a6d.jpg'\n  )\n\n  // 2. 绘制场景\n  drawScene(gl, programInfo, buffers, texture)\n\n  let d = 6\n  let r = 0\n\n  const step = () => {\n    r += 0.1\n    drawScene(gl, programInfo, buffers, texture, d, r)\n    requestAnimationFrame(step)\n  }\n  requestAnimationFrame(step)\n}\n\n// 创建 着色器连接程序，将 顶点着色器 和 片段着色器 连接起来\nfunction initShaderProgram(gl, vsScource, fsSource) {\n  const vsShader = loadShader(gl, gl.VERTEX_SHADER, vsScource)\n  const fsShader = loadShader(gl, gl.FRAGMENT_SHADER, fsSource)\n\n  const shaderProgram = gl.createProgram()\n  // 0. 附加着色器\n  gl.attachShader(shaderProgram, vsShader)\n  // 0. 附加着色器\n  gl.attachShader(shaderProgram, fsShader)\n  // 1. 连接着色器\n  gl.linkProgram(shaderProgram)\n\n  if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {\n    alert('创建 着色器连接程序 失败!' + gl.getProgramInfoLog(shaderProgram))\n    return null\n  }\n\n  return shaderProgram\n}\n\n// 创建着色器\nfunction loadShader(gl, type, source) {\n  // 0. 创建指定类型的 着色器\n  const shader = gl.createShader(type)\n  // 1. 上传 着色器源码\n  gl.shaderSource(shader, source)\n  // 2. 编译着色器\n  gl.compileShader(shader)\n\n  // 3. 检测 着色器 是否编译成功\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n    alert('编译着色器失败！' + gl.getShaderInfoLog(shader))\n    gl.deleteShader(shader)\n    return null\n  }\n\n  return shader\n}\n\n// 创建 缓冲区\nfunction initBuffers(gl) {\n  // 0. 创建 buffer 存储正方形顶点\n  const buffer = gl.createBuffer()\n\n  gl.bindBuffer(gl.ARRAY_BUFFER, buffer)\n\n  // 1. 将顶点传入 WebGL\n  const positions = [\n    // Front face\n    -1.0,\n    -1.0,\n    1.0,\n    1.0,\n    -1.0,\n    1.0,\n    1.0,\n    1.0,\n    1.0,\n    -1.0,\n    1.0,\n    1.0,\n\n    // Back face\n    -1.0,\n    -1.0,\n    -1.0,\n    -1.0,\n    1.0,\n    -1.0,\n    1.0,\n    1.0,\n    -1.0,\n    1.0,\n    -1.0,\n    -1.0,\n\n    // Top face\n    -1.0,\n    1.0,\n    -1.0,\n    -1.0,\n    1.0,\n    1.0,\n    1.0,\n    1.0,\n    1.0,\n    1.0,\n    1.0,\n    -1.0,\n\n    // Bottom face\n    -1.0,\n    -1.0,\n    -1.0,\n    1.0,\n    -1.0,\n    -1.0,\n    1.0,\n    -1.0,\n    1.0,\n    -1.0,\n    -1.0,\n    1.0,\n\n    // Right face\n    1.0,\n    -1.0,\n    -1.0,\n    1.0,\n    1.0,\n    -1.0,\n    1.0,\n    1.0,\n    1.0,\n    1.0,\n    -1.0,\n    1.0,\n\n    // Left face\n    -1.0,\n    -1.0,\n    -1.0,\n    -1.0,\n    -1.0,\n    1.0,\n    -1.0,\n    1.0,\n    1.0,\n    -1.0,\n    1.0,\n    -1.0\n  ]\n  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(positions), gl.STATIC_DRAW)\n\n  // 三角形数组\n\n  var cubeVerticesIndexBuffer = gl.createBuffer()\n  gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, cubeVerticesIndexBuffer)\n\n  // This array defines each face as two triangles, using the\n  // indices into the vertex array to specify each triangle's\n  // position.\n\n  var cubeVertexIndices = [\n    0,\n    1,\n    2,\n    0,\n    2,\n    3, // front\n    4,\n    5,\n    6,\n    4,\n    6,\n    7, // back\n    8,\n    9,\n    10,\n    8,\n    10,\n    11, // top\n    12,\n    13,\n    14,\n    12,\n    14,\n    15, // bottom\n    16,\n    17,\n    18,\n    16,\n    18,\n    19, // right\n    20,\n    21,\n    22,\n    20,\n    22,\n    23 // left\n  ]\n\n  // Now send the element array to GL\n\n  gl.bufferData(\n    gl.ELEMENT_ARRAY_BUFFER,\n    new Uint16Array(cubeVertexIndices),\n    gl.STATIC_DRAW\n  )\n\n  const textureCoordBuffer = gl.createBuffer()\n  gl.bindBuffer(gl.ARRAY_BUFFER, textureCoordBuffer)\n\n  const textureCoordinates = [\n    // Front\n    0.0,\n    0.0,\n    1.0,\n    0.0,\n    1.0,\n    1.0,\n    0.0,\n    1.0,\n    // Back\n    0.0,\n    0.0,\n    1.0,\n    0.0,\n    1.0,\n    1.0,\n    0.0,\n    1.0,\n    // Top\n    0.0,\n    0.0,\n    1.0,\n    0.0,\n    1.0,\n    1.0,\n    0.0,\n    1.0,\n    // Bottom\n    0.0,\n    0.0,\n    1.0,\n    0.0,\n    1.0,\n    1.0,\n    0.0,\n    1.0,\n    // Right\n    0.0,\n    0.0,\n    1.0,\n    0.0,\n    1.0,\n    1.0,\n    0.0,\n    1.0,\n    // Left\n    0.0,\n    0.0,\n    1.0,\n    0.0,\n    1.0,\n    1.0,\n    0.0,\n    1.0\n  ]\n\n  gl.bufferData(\n    gl.ARRAY_BUFFER,\n    new Float32Array(textureCoordinates),\n    gl.STATIC_DRAW\n  )\n\n  // 法线\n  const cubeVerticesNormalBuffer = gl.createBuffer()\n  gl.bindBuffer(gl.ARRAY_BUFFER, cubeVerticesNormalBuffer)\n\n  var vertexNormals = [\n    // Front\n    0.0,\n    0.0,\n    1.0,\n    0.0,\n    0.0,\n    1.0,\n    0.0,\n    0.0,\n    1.0,\n    0.0,\n    0.0,\n    1.0,\n\n    // Back\n    0.0,\n    0.0,\n    -1.0,\n    0.0,\n    0.0,\n    -1.0,\n    0.0,\n    0.0,\n    -1.0,\n    0.0,\n    0.0,\n    -1.0,\n\n    // Top\n    0.0,\n    1.0,\n    0.0,\n    0.0,\n    1.0,\n    0.0,\n    0.0,\n    1.0,\n    0.0,\n    0.0,\n    1.0,\n    0.0,\n\n    // Bottom\n    0.0,\n    -1.0,\n    0.0,\n    0.0,\n    -1.0,\n    0.0,\n    0.0,\n    -1.0,\n    0.0,\n    0.0,\n    -1.0,\n    0.0,\n\n    // Right\n    1.0,\n    0.0,\n    0.0,\n    1.0,\n    0.0,\n    0.0,\n    1.0,\n    0.0,\n    0.0,\n    1.0,\n    0.0,\n    0.0,\n\n    // Left\n    -1.0,\n    0.0,\n    0.0,\n    -1.0,\n    0.0,\n    0.0,\n    -1.0,\n    0.0,\n    0.0,\n    -1.0,\n    0.0,\n    0.0\n  ]\n\n  gl.bufferData(\n    gl.ARRAY_BUFFER,\n    new Float32Array(vertexNormals),\n    gl.STATIC_DRAW\n  )\n\n  return {\n    position: buffer,\n    textureCoord: textureCoordBuffer,\n    // color: colorBuffer,\n    cubeVerticesNormalBuffer,\n    cubeVerticesIndexBuffer\n  }\n}\n\n// 绘制场景\nfunction drawScene(gl, programInfo, buffers, texture, z = 10.0, rotate = 0) {\n  gl.clearColor(0.0, 0.0, 0.0, 1)\n  gl.clearDepth(1) // 清空\n  gl.enable(gl.DEPTH_TEST)\n  gl.depthFunc(gl.LEQUAL)\n\n  gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT)\n\n  // 利用 gl-matrix 创建一个 透视投影相机\n  const feildOfView = (45 * Math.PI) / 180\n  const aspect = gl.canvas.clientWidth / gl.canvas.clientHeight\n  const zNear = 1\n  const zFar = 100.0\n  const projectionMatrix = mat4.create()\n  mat4.perspective(projectionMatrix, feildOfView, aspect, zNear, zFar)\n\n  const modelViewMatrix = mat4.create()\n  mat4.translate(modelViewMatrix, modelViewMatrix, [0, 0.0, -z])\n\n  mat4.rotate(\n    modelViewMatrix, // destination matrix\n    modelViewMatrix, // matrix to rotate\n    rotate, // amount to rotate in radians\n    [2, 0, 8]\n  )\n\n  mat4.rotate(\n    modelViewMatrix, // destination matrix\n    modelViewMatrix, // matrix to rotate\n    rotate * 0.7, // amount to rotate in radians\n    [2, 1, -8]\n  )\n\n  const normalMatrix = mat4.create()\n  mat4.invert(normalMatrix, modelViewMatrix)\n  mat4.transpose(normalMatrix, normalMatrix)\n\n  {\n    const numComponents = 3\n    const type = gl.FLOAT\n    const normalize = false\n    const stride = 0\n    const offset = 0\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffers.position)\n    gl.vertexAttribPointer(\n      programInfo.attribLocations.vertexPosition,\n      numComponents,\n      type,\n      normalize,\n      stride,\n      offset\n    )\n    gl.enableVertexAttribArray(programInfo.attribLocations.vertexPosition)\n  }\n\n  // Tell WebGL how to pull out the normals from\n  // the normal buffer into the vertexNormal attribute.\n  {\n    const numComponents = 3\n    const type = gl.FLOAT\n    const normalize = false\n    const stride = 0\n    const offset = 0\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffers.cubeVerticesNormalBuffer)\n    gl.vertexAttribPointer(\n      programInfo.attribLocations.vertexNormal,\n      numComponents,\n      type,\n      normalize,\n      stride,\n      offset\n    )\n    gl.enableVertexAttribArray(programInfo.attribLocations.vertexNormal)\n  }\n\n  {\n    const numComponents = 2\n    const type = gl.FLOAT\n    const normalize = false\n    const stride = 0\n    const offset = 0\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffers.textureCoord)\n    gl.vertexAttribPointer(\n      programInfo.attribLocations.textureCoord,\n      numComponents,\n      type,\n      normalize,\n      stride,\n      offset\n    )\n    gl.enableVertexAttribArray(programInfo.attribLocations.textureCoord)\n  }\n\n  gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, buffers.cubeVerticesIndexBuffer)\n\n  // 告知 WebGL 使用 着色器 绘制\n  gl.useProgram(programInfo.program)\n\n  gl.uniformMatrix4fv(\n    programInfo.uniformLocations.projectionMatrix,\n    false,\n    projectionMatrix\n  )\n  gl.uniformMatrix4fv(\n    programInfo.uniformLocations.modelViewMatrix,\n    false,\n    modelViewMatrix\n  )\n  gl.uniformMatrix4fv(\n    programInfo.uniformLocations.normalMatrix,\n    false,\n    normalMatrix\n  )\n\n  // Tell WebGL we want to affect texture unit 0\n  gl.activeTexture(gl.TEXTURE0)\n\n  // Bind the texture to texture unit 0\n  gl.bindTexture(gl.TEXTURE_2D, texture)\n\n  // Tell the shader we bound the texture to texture unit 0\n  gl.uniform1i(programInfo.uniformLocations.sampler, 0)\n\n  {\n    // const offset = 0;\n    // const vertexCount = 4;\n    // gl.drawArrays(gl.TRIANGLE_STRIP, offset, vertexCount);\n\n    const vertexCount = 36 // 可以尝试修改，一个面 2 个三角形，6个顶点\n    const type = gl.UNSIGNED_SHORT\n    const offset = 0\n    gl.drawElements(gl.TRIANGLES, vertexCount, type, offset)\n  }\n}\n\n/* 加载纹理，贴图  */\nfunction loadTextures(gl, url) {\n  const texture = gl.createTexture()\n  gl.bindTexture(gl.TEXTURE_2D, texture)\n\n  // Because images have to be download over the internet\n  // they might take a moment until they are ready.\n  // Until then put a single pixel in the texture so we can\n  // use it immediately. When the image has finished downloading\n  // we'll update the texture with the contents of the image.\n  const level = 0\n  const internalFormat = gl.RGBA\n  const width = 1\n  const height = 1\n  const border = 0\n  const srcFormat = gl.RGBA\n  const srcType = gl.UNSIGNED_BYTE\n  const pixel = new Uint8Array([0, 0, 255, 255]) // opaque blue\n  gl.texImage2D(\n    gl.TEXTURE_2D,\n    level,\n    internalFormat,\n    width,\n    height,\n    border,\n    srcFormat,\n    srcType,\n    pixel\n  )\n\n  const image = new Image()\n  image.crossOrigin = ''\n  image.onload = function() {\n    gl.bindTexture(gl.TEXTURE_2D, texture)\n    gl.texImage2D(\n      gl.TEXTURE_2D,\n      level,\n      internalFormat,\n      srcFormat,\n      srcType,\n      image\n    )\n\n    if (isPowerOf2(image.width) && isPowerOf2(image.height)) {\n      gl.generateMipmap(gl.TEXTURE_2D)\n    } else {\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE)\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE)\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR)\n    }\n  }\n  image.src = url\n\n  return texture\n}\n\nfunction isPowerOf2(value) {\n  return (value & (value - 1)) == 0\n}\n"}},[r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" app = "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[n._v("document")]),n._v(".querySelector("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v("'#app'")]),n._v(")\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" canvas = "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[n._v("document")]),n._v(".createElement("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v("'canvas'")]),n._v(")\ncanvas.width = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("400")]),n._v("\ncanvas.height = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("300")]),n._v("\n\napp.appendChild(canvas)\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" gl = canvas.getContext("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v("'webgl'")]),n._v(")\n\nstart()\n\n"),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("function")]),n._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title"}},[n._v("start")]),n._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),n._v(") ")]),n._v("{\n  \n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" vsScource = "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v("`\n        attribute vec4 aVertexPosition;\n        attribute vec3 aVertexNormal;\n        attribute vec2 aTextureCoord;\n\n        uniform mat4 uModelViewMatrix;\n        uniform mat4 uNormalMatrix;\n        uniform mat4 uProjectionMatrix;\n\n        varying highp vec2 vTextureCoord;\n        varying highp vec3 vLighting;\n\n        void main() {\n          vTextureCoord = aTextureCoord;\n          gl_Position  = uProjectionMatrix * uModelViewMatrix * aVertexPosition;\n\n\n          highp vec3 ambientLight = vec3(0.3, 0.3, 0.3);\n          highp vec3 directionalLightColor = vec3(1, 1, 1);\n          highp vec3 directionalVector = normalize(vec3(0.85, 0.8, 0.75));\n          highp vec4 transformedNormal = uNormalMatrix * vec4(aVertexNormal, 1.0);\n          highp float directional = max(dot(transformedNormal.xyz, directionalVector), 0.0);\n          vLighting = ambientLight + (directionalLightColor * directional);\n        }\n\n\n      `")]),n._v("\n\n  \n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" fsSource = "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v("`\n        varying highp vec2 vTextureCoord;\n        varying highp vec3 vLighting;\n\n        uniform sampler2D uSampler;\n\n        void main() {\n          highp vec4 texelColor = texture2D(uSampler, vTextureCoord);\n          gl_FragColor = vec4(texelColor.rgb * vLighting, texelColor.a);\n        }\n      `")]),n._v("\n\n  \n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" shaderProgram = initShaderProgram(gl, vsScource, fsSource)\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" programInfo = {\n    "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[n._v("program")]),n._v(": shaderProgram,\n    "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[n._v("attribLocations")]),n._v(": {\n      "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[n._v("vertexPosition")]),n._v(": gl.getAttribLocation(shaderProgram, "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v("'aVertexPosition'")]),n._v("),\n      \n      textureCoord: gl.getAttribLocation(shaderProgram, "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v("'aTextureCoord'")]),n._v("),\n      "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[n._v("vertexNormal")]),n._v(": gl.getAttribLocation(shaderProgram, "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v("'aVertexNormal'")]),n._v(")\n    },\n    "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[n._v("uniformLocations")]),n._v(": {\n      "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[n._v("projectionMatrix")]),n._v(": gl.getUniformLocation(\n        shaderProgram,\n        "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v("'uProjectionMatrix'")]),n._v("\n      ),\n      "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[n._v("modelViewMatrix")]),n._v(": gl.getUniformLocation(shaderProgram, "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v("'uModelViewMatrix'")]),n._v("),\n      "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[n._v("sampler")]),n._v(": gl.getUniformLocation(shaderProgram, "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v("'uSampler'")]),n._v("),\n      "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[n._v("normalMatrix")]),n._v(": gl.getUniformLocation(shaderProgram, "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v("'uNormalMatrix'")]),n._v(")\n    }\n  }\n\n  \n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" buffers = initBuffers(gl)\n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" texture = loadTextures(\n    gl,\n    "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v("'http://p4.qhimg.com/t01836de9c0b1068a6d.jpg'")]),n._v("\n  )\n\n  \n  drawScene(gl, programInfo, buffers, texture)\n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("let")]),n._v(" d = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("6")]),n._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("let")]),n._v(" r = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")]),n._v("\n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" step = "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[n._v("()")]),n._v(" =>")]),n._v(" {\n    r += "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.1")]),n._v("\n    drawScene(gl, programInfo, buffers, texture, d, r)\n    requestAnimationFrame(step)\n  }\n  requestAnimationFrame(step)\n}\n\n\n"),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("function")]),n._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title"}},[n._v("initShaderProgram")]),n._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[n._v("gl, vsScource, fsSource")]),n._v(") ")]),n._v("{\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" vsShader = loadShader(gl, gl.VERTEX_SHADER, vsScource)\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" fsShader = loadShader(gl, gl.FRAGMENT_SHADER, fsSource)\n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" shaderProgram = gl.createProgram()\n  \n  gl.attachShader(shaderProgram, vsShader)\n  \n  gl.attachShader(shaderProgram, fsShader)\n  \n  gl.linkProgram(shaderProgram)\n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("if")]),n._v(" (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {\n    alert("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v("'创建 着色器连接程序 失败!'")]),n._v(" + gl.getProgramInfoLog(shaderProgram))\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("return")]),n._v(" "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[n._v("null")]),n._v("\n  }\n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("return")]),n._v(" shaderProgram\n}\n\n\n"),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("function")]),n._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title"}},[n._v("loadShader")]),n._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[n._v("gl, type, source")]),n._v(") ")]),n._v("{\n  \n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" shader = gl.createShader(type)\n  \n  gl.shaderSource(shader, source)\n  \n  gl.compileShader(shader)\n\n  \n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("if")]),n._v(" (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n    alert("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v("'编译着色器失败！'")]),n._v(" + gl.getShaderInfoLog(shader))\n    gl.deleteShader(shader)\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("return")]),n._v(" "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[n._v("null")]),n._v("\n  }\n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("return")]),n._v(" shader\n}\n\n\n"),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("function")]),n._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title"}},[n._v("initBuffers")]),n._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[n._v("gl")]),n._v(") ")]),n._v("{\n  \n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" buffer = gl.createBuffer()\n\n  gl.bindBuffer(gl.ARRAY_BUFFER, buffer)\n\n  \n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" positions = [\n    \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n\n    \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n\n    \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n\n    \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n\n    \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n\n    \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v("\n  ]\n  gl.bufferData(gl.ARRAY_BUFFER, "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("new")]),n._v(" "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[n._v("Float32Array")]),n._v("(positions), gl.STATIC_DRAW)\n\n  \n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("var")]),n._v(" cubeVerticesIndexBuffer = gl.createBuffer()\n  gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, cubeVerticesIndexBuffer)\n\n  \n  \n  \n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("var")]),n._v(" cubeVertexIndices = [\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("2")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("2")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("3")]),n._v(", \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("4")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("5")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("6")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("4")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("6")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("7")]),n._v(", \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("8")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("9")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("10")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("8")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("10")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("11")]),n._v(", \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("12")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("13")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("14")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("12")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("14")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("15")]),n._v(", \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("16")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("17")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("18")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("16")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("18")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("19")]),n._v(", \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("20")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("21")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("22")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("20")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("22")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("23")]),n._v(" \n  ]\n\n  \n\n  gl.bufferData(\n    gl.ELEMENT_ARRAY_BUFFER,\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("new")]),n._v(" "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[n._v("Uint16Array")]),n._v("(cubeVertexIndices),\n    gl.STATIC_DRAW\n  )\n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" textureCoordBuffer = gl.createBuffer()\n  gl.bindBuffer(gl.ARRAY_BUFFER, textureCoordBuffer)\n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" textureCoordinates = [\n    \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v("\n  ]\n\n  gl.bufferData(\n    gl.ARRAY_BUFFER,\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("new")]),n._v(" "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[n._v("Float32Array")]),n._v("(textureCoordinates),\n    gl.STATIC_DRAW\n  )\n\n  \n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" cubeVerticesNormalBuffer = gl.createBuffer()\n  gl.bindBuffer(gl.ARRAY_BUFFER, cubeVerticesNormalBuffer)\n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("var")]),n._v(" vertexNormals = [\n    \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n\n    \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n\n    \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n\n    \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n\n    \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n\n    \n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-1.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(",\n    "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v("\n  ]\n\n  gl.bufferData(\n    gl.ARRAY_BUFFER,\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("new")]),n._v(" "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[n._v("Float32Array")]),n._v("(vertexNormals),\n    gl.STATIC_DRAW\n  )\n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("return")]),n._v(" {\n    "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[n._v("position")]),n._v(": buffer,\n    "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[n._v("textureCoord")]),n._v(": textureCoordBuffer,\n    \n    cubeVerticesNormalBuffer,\n    cubeVerticesIndexBuffer\n  }\n}\n\n\n"),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("function")]),n._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title"}},[n._v("drawScene")]),n._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[n._v("gl, programInfo, buffers, texture, z = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("10.0")]),n._v(", rotate = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")])]),n._v(") ")]),n._v("{\n  gl.clearColor("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1")]),n._v(")\n  gl.clearDepth("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1")]),n._v(") \n  gl.enable(gl.DEPTH_TEST)\n  gl.depthFunc(gl.LEQUAL)\n\n  gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT)\n\n  \n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" feildOfView = ("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("45")]),n._v(" * "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[n._v("Math")]),n._v(".PI) / "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("180")]),n._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" aspect = gl.canvas.clientWidth / gl.canvas.clientHeight\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" zNear = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1")]),n._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" zFar = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("100.0")]),n._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" projectionMatrix = mat4.create()\n  mat4.perspective(projectionMatrix, feildOfView, aspect, zNear, zFar)\n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" modelViewMatrix = mat4.create()\n  mat4.translate(modelViewMatrix, modelViewMatrix, ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")]),n._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(", -z])\n\n  mat4.rotate(\n    modelViewMatrix, \n    modelViewMatrix, \n    rotate, \n    ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("2")]),n._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")]),n._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("8")]),n._v("]\n  )\n\n  mat4.rotate(\n    modelViewMatrix, \n    modelViewMatrix, \n    rotate * "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.7")]),n._v(", \n    ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("2")]),n._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1")]),n._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("-8")]),n._v("]\n  )\n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" normalMatrix = mat4.create()\n  mat4.invert(normalMatrix, modelViewMatrix)\n  mat4.transpose(normalMatrix, normalMatrix)\n\n  {\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" numComponents = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("3")]),n._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" type = gl.FLOAT\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" normalize = "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[n._v("false")]),n._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" stride = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")]),n._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" offset = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")]),n._v("\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffers.position)\n    gl.vertexAttribPointer(\n      programInfo.attribLocations.vertexPosition,\n      numComponents,\n      type,\n      normalize,\n      stride,\n      offset\n    )\n    gl.enableVertexAttribArray(programInfo.attribLocations.vertexPosition)\n  }\n\n  \n  \n  {\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" numComponents = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("3")]),n._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" type = gl.FLOAT\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" normalize = "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[n._v("false")]),n._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" stride = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")]),n._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" offset = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")]),n._v("\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffers.cubeVerticesNormalBuffer)\n    gl.vertexAttribPointer(\n      programInfo.attribLocations.vertexNormal,\n      numComponents,\n      type,\n      normalize,\n      stride,\n      offset\n    )\n    gl.enableVertexAttribArray(programInfo.attribLocations.vertexNormal)\n  }\n\n  {\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" numComponents = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("2")]),n._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" type = gl.FLOAT\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" normalize = "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[n._v("false")]),n._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" stride = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")]),n._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" offset = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")]),n._v("\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffers.textureCoord)\n    gl.vertexAttribPointer(\n      programInfo.attribLocations.textureCoord,\n      numComponents,\n      type,\n      normalize,\n      stride,\n      offset\n    )\n    gl.enableVertexAttribArray(programInfo.attribLocations.textureCoord)\n  }\n\n  gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, buffers.cubeVerticesIndexBuffer)\n\n  \n  gl.useProgram(programInfo.program)\n\n  gl.uniformMatrix4fv(\n    programInfo.uniformLocations.projectionMatrix,\n    "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[n._v("false")]),n._v(",\n    projectionMatrix\n  )\n  gl.uniformMatrix4fv(\n    programInfo.uniformLocations.modelViewMatrix,\n    "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[n._v("false")]),n._v(",\n    modelViewMatrix\n  )\n  gl.uniformMatrix4fv(\n    programInfo.uniformLocations.normalMatrix,\n    "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[n._v("false")]),n._v(",\n    normalMatrix\n  )\n\n  \n  gl.activeTexture(gl.TEXTURE0)\n\n  \n  gl.bindTexture(gl.TEXTURE_2D, texture)\n\n  \n  gl.uniform1i(programInfo.uniformLocations.sampler, "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")]),n._v(")\n\n  {\n    \n    \n    \n\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" vertexCount = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("36")]),n._v(" \n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" type = gl.UNSIGNED_SHORT\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" offset = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")]),n._v("\n    gl.drawElements(gl.TRIANGLES, vertexCount, type, offset)\n  }\n}\n\n\n"),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("function")]),n._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title"}},[n._v("loadTextures")]),n._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[n._v("gl, url")]),n._v(") ")]),n._v("{\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" texture = gl.createTexture()\n  gl.bindTexture(gl.TEXTURE_2D, texture)\n\n  \n  \n  \n  \n  \n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" level = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")]),n._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" internalFormat = gl.RGBA\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" width = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1")]),n._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" height = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1")]),n._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" border = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")]),n._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" srcFormat = gl.RGBA\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" srcType = gl.UNSIGNED_BYTE\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" pixel = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("new")]),n._v(" "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[n._v("Uint8Array")]),n._v("(["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")]),n._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")]),n._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("255")]),n._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("255")]),n._v("]) \n  gl.texImage2D(\n    gl.TEXTURE_2D,\n    level,\n    internalFormat,\n    width,\n    height,\n    border,\n    srcFormat,\n    srcType,\n    pixel\n  )\n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("const")]),n._v(" image = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("new")]),n._v(" Image()\n  image.crossOrigin = "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v("''")]),n._v("\n  image.onload = "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("function")]),n._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),n._v(") ")]),n._v("{\n    gl.bindTexture(gl.TEXTURE_2D, texture)\n    gl.texImage2D(\n      gl.TEXTURE_2D,\n      level,\n      internalFormat,\n      srcFormat,\n      srcType,\n      image\n    )\n\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("if")]),n._v(" (isPowerOf2(image.width) && isPowerOf2(image.height)) {\n      gl.generateMipmap(gl.TEXTURE_2D)\n    } "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("else")]),n._v(" {\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE)\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE)\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR)\n    }\n  }\n  image.src = url\n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("return")]),n._v(" texture\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("function")]),n._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title"}},[n._v("isPowerOf2")]),n._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[n._v("value")]),n._v(") ")]),n._v("{\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("return")]),n._v(" (value & (value - "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1")]),n._v(")) == "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")]),n._v("\n}\n")])])])],1)},[function(){var n=this,s=n.$createElement,r=n._self._c||s;return r("ul",[r("li",[r("strong",[n._v("环境光")]),n._v(": 一种可以渗透到场景的每一个角落的光。它是非方向光并且会均匀地照射物体的每一个面，无论这个面是朝向哪个方向的。")]),n._v(" "),r("li",[r("strong",[n._v("方向光")]),n._v(": 一束从一个固定的方向照射过来的光。这种光的特点可以理解为好像是从一个很遥远的地方照射过来的，然后光线中的每一个光子与其它光子都是平行运动的。举个例子来说，阳光就可以认为是方向光。")]),n._v(" "),r("li",[r("strong",[n._v("点光源光")]),n._v(": 指光线是从一个点发射出来的，是向着四面八方发射的。这种光在我们的现实生活中是最常被用到的。举个例子来说，电灯泡就是向各个方向发射光线的。")])])},function(){var n=this.$createElement,s=this._self._c||n;return s("ol",[s("li",[this._v("需要在每个顶点信息中加入面的朝向法线。这个法线是一个垂直于这个顶点所在平面的向量。")]),this._v(" "),s("li",[this._v("需要明确方向光的传播方向，可以使用一个方向向量来定义。")])])},function(){var n=this.$createElement,s=this._self._c||n;return s("pre",{pre:!0},[s("code",{pre:!0,attrs:{"v-pre":""}},[this._v("cubeVerticesNormalBuffer = gl.createBuffer()\ngl.bindBuffer(gl.ARRAY_BUFFER, cubeVerticesNormalBuffer)\n\nvar vertexNormals = [\n  // Front\n   0.0,  0.0,  1.0,\n   0.0,  0.0,  1.0,\n   0.0,  0.0,  1.0,\n   0.0,  0.0,  1.0,\n\n  // Back\n   0.0,  0.0, -1.0,\n   0.0,  0.0, -1.0,\n   0.0,  0.0, -1.0,\n   0.0,  0.0, -1.0,\n\n  // Top\n   0.0,  1.0,  0.0,\n   0.0,  1.0,  0.0,\n   0.0,  1.0,  0.0,\n   0.0,  1.0,  0.0,\n\n  // Bottom\n   0.0, -1.0,  0.0,\n   0.0, -1.0,  0.0,\n   0.0, -1.0,  0.0,\n   0.0, -1.0,  0.0,\n\n  // Right\n   1.0,  0.0,  0.0,\n   1.0,  0.0,  0.0,\n   1.0,  0.0,  0.0,\n   1.0,  0.0,  0.0,\n\n  // Left\n  -1.0,  0.0,  0.0,\n  -1.0,  0.0,  0.0,\n  -1.0,  0.0,  0.0,\n  -1.0,  0.0,  0.0\n];\n\ngl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertexNormals), gl.STATIC_DRAW)\n")])])},function(){var n=this.$createElement,s=this._self._c||n;return s("p",[this._v("然后在 "),s("code",{pre:!0},[this._v("drawScene()")]),this._v("中添加代码，将法线数组和着色器的 attribute 绑定起来以便着色器能够获取到法线数组的信息。")])},function(){var n=this,s=n.$createElement,r=n._self._c||s;return r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[n._v("gl.bindBuffer(gl.ARRAY_BUFFER, cubeVerticesNormalBuffer)\ngl.vertexAttribPointer(vertexNormalAttribute, "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("3")]),n._v(", gl.FLOAT, "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[n._v("false")]),n._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")]),n._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0")]),n._v(")\n")])])},function(){var n=this,s=n.$createElement,r=n._self._c||s;return r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("var")]),n._v(" normalMatrix = mvMatrix.inverse()\nnormalMatrix = normalMatrix.transpose()\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("var")]),n._v(" nUniform = gl.getUniformLocation(shaderProgram, "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v("'uNormalMatrix'")]),n._v(")\ngl.uniformMatrix4fv(\n  nUniform,\n  "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[n._v("false")]),n._v(",\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("new")]),n._v(" WebGLFloatArray(normalMatrix.flatten())\n)\n")])])},function(){var n=this,s=n.$createElement,r=n._self._c||s;return r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[r("span",{pre:!0,attrs:{class:"hljs-tag"}},[n._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[n._v("script")]),n._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[n._v("id")]),n._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v('"shader-vs"')]),n._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[n._v("type")]),n._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v('"x-shader/x-vertex"')]),n._v(">")]),r("span",{pre:!0,attrs:{class:"actionscript"}},[n._v("\n  attribute highp vec3 aVertexNormal;\n  attribute highp vec3 aVertexPosition;\n  attribute highp vec2 aTextureCoord;\n\n  uniform highp mat4 uNormalMatrix;\n  uniform highp mat4 uMVMatrix;\n  uniform highp mat4 uPMatrix;\n\n  varying highp vec2 vTextureCoord;\n  varying highp vec3 vLighting;\n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("void")]),n._v(" main("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("void")]),n._v(") {\n    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(");\n    vTextureCoord = aTextureCoord;\n\n    \n\n    highp vec3 ambientLight = vec3("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.6")]),n._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.6")]),n._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.6")]),n._v(");\n    highp vec3 directionalLightColor = vec3("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.5")]),n._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.5")]),n._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.75")]),n._v(");\n    highp vec3 directionalVector = vec3("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.85")]),n._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.8")]),n._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.75")]),n._v(");\n\n    highp vec4 transformedNormal = uNormalMatrix * vec4(aVertexNormal, "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("1.0")]),n._v(");\n\n    highp float directional = max(dot(transformedNormal.xyz, directionalVector), "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[n._v("0.0")]),n._v(");\n    vLighting = ambientLight + (directionalLightColor * directional);\n  }\n")]),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[n._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[n._v("script")]),n._v(">")]),n._v("\n")])])},function(){var n=this,s=n.$createElement,r=n._self._c||s;return r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[r("span",{pre:!0,attrs:{class:"hljs-tag"}},[n._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[n._v("script")]),n._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[n._v("id")]),n._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v('"shader-fs"')]),n._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[n._v("type")]),n._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[n._v('"x-shader/x-fragment"')]),n._v(">")]),r("span",{pre:!0,attrs:{class:"actionscript"}},[n._v("\n  varying highp vec2 vTextureCoord;\n  varying highp vec3 vLighting;\n\n  uniform sampler2D uSampler;\n\n  "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("void")]),n._v(" main("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[n._v("void")]),n._v(") {\n    mediump vec4 texelColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n\n    gl_FragColor = vec4(texelColor.rgb * vLighting, texelColor.a);\n  }\n")]),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[n._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[n._v("script")]),n._v(">")]),n._v("\n")])])}],!1,null,null,null);s.default=t.exports}}]);